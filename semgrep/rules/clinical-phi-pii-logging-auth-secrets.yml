rules:
  - id: clinical-phi-detect
    pattern: "(patient_id|ssn|nss|nif|dni|passport|insurance|dob|address|phone|email)"
    message: "Posible dato PHI/PII detectado."
    severity: ERROR
    languages: [python, yaml, json]
    metadata:
      category: phi-pii
      technology: clinical

  - id: clinical-logging-secrets
    pattern: "logging\.(debug|info|warning|error|critical)\((.*(password|secret|token|key|credential).*)\)"
    message: "No loggear secretos ni credenciales."
    severity: ERROR
    languages: [python]
    metadata:
      category: logging
      technology: clinical

  - id: clinical-auth-header
    pattern: "Authorization: Bearer"
    message: "Verifica manejo seguro de Authorization headers."
    severity: WARNING
    languages: [python, yaml]
    metadata:
      category: auth
      technology: clinical
